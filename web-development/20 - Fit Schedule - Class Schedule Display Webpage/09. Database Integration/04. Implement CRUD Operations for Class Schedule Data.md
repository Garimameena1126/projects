

### Module 9: Database Integration

#### Task: Modify the backend code to handle CRUD operations for the class schedule data.

1. Choose a suitable database system to store and manage class schedule data. In this example, we'll use MongoDB as the database system. Make sure you have MongoDB installed and running on your system.

2. Design a database schema that accommodates class names, timings, instructors, and additional details. For simplicity, we'll create a single collection named "classes" with the following fields:

   - `_id`: The unique identifier for each class (automatically generated by MongoDB).
   - `className`: The name of the class.
   - `timing`: The timing of the class.
   - `instructor`: The instructor of the class.
   - `details`: Additional details about the class.

3. Set up the necessary database tables/collections and establish a connection between the backend and the MongoDB database.

   - Install the required dependencies:
     - Open a terminal or command prompt.
     - Navigate to your project's directory.
     - Run the following command to install the MongoDB driver for Node.js:

     ```shell
     npm install mongodb
     ```

   - In your backend code, require the MongoDB driver:

     ```javascript
     const MongoClient = require('mongodb').MongoClient;
     ```

   - Define a connection string to connect to your MongoDB database. Replace `<database_url>` with the actual URL of your MongoDB database.

     ```javascript
     const url = '<database_url>';
     ```

   - Establish a connection to the MongoDB database:

     ```javascript
     MongoClient.connect(url, function (err, client) {
       if (err) {
         console.log('Error occurred while connecting to MongoDB.', err);
       } else {
         console.log('Connected to MongoDB successfully!');
         const db = client.db('<database_name>'); // Replace <database_name> with the name of your database

         // Your CRUD operations will go here

         client.close();
       }
     });
     ```

     Explanation:
     - The `MongoClient.connect()` method connects to the MongoDB database specified by the URL.
     - Inside the callback function, you can perform database operations.

4. Modify the backend code to handle CRUD operations for the class schedule data.

   - Create a new class:

     ```javascript
     // Create a new class
     app.post('/classes', function (req, res) {
       const newClass = {
         className: req.body.className,
         timing: req.body.timing,
         instructor: req.body.instructor,
         details: req.body.details,
       };

       db.collection('classes').insertOne(newClass, function (err, result) {
         if (err) {
           res.status(500).send('Error creating class.');
         } else {
           res.status(201).send('Class created successfully.');
         }
       });
     });
     ```

   - Read all classes:

     ```javascript
     // Read all classes
     app.get('/classes', function (req, res) {
       db.collection('classes')
         .find()
         .toArray(function (err, classes) {
           if (err) {
             res.status(500).send('Error retrieving classes.');
           } else {
             res.status(200).json(classes);
           }
         });
     });
     ```

   - Read a specific class by ID:

     ```javascript
     // Read a specific class by ID
     app.get('/classes/:id', function (req, res) {
       const classId = req.params.id;

       db

.collection('classes').findOne({ _id: ObjectId(classId) }, function (
         err,
         classObj
       ) {
         if (err) {
           res.status(500).send('Error retrieving class.');
         } else if (!classObj) {
           res.status(404).send('Class not found.');
         } else {
           res.status(200).json(classObj);
         }
       });
     });
     ```

   - Update a specific class:

     ```javascript
     // Update a specific class
     app.put('/classes/:id', function (req, res) {
       const classId = req.params.id;
       const updatedClass = {
         className: req.body.className,
         timing: req.body.timing,
         instructor: req.body.instructor,
         details: req.body.details,
       };

       db.collection('classes').updateOne(
         { _id: ObjectId(classId) },
         { $set: updatedClass },
         function (err, result) {
           if (err) {
             res.status(500).send('Error updating class.');
           } else if (result.modifiedCount === 0) {
             res.status(404).send('Class not found.');
           } else {
             res.status(200).send('Class updated successfully.');
           }
         }
       );
     });
     ```

   - Delete a specific class:

     ```javascript
     // Delete a specific class
     app.delete('/classes/:id', function (req, res) {
       const classId = req.params.id;

       db.collection('classes').deleteOne(
         { _id: ObjectId(classId) },
         function (err, result) {
           if (err) {
             res.status(500).send('Error deleting class.');
           } else if (result.deletedCount === 0) {
             res.status(404).send('Class not found.');
           } else {
             res.status(200).send('Class deleted successfully.');
           }
         }
       );
     });
     ```

5. Save your backend code.

